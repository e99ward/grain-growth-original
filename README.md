Original C++ Version (ver. C)
